<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Firestore Rules Test</title>
</head>
<body>
  <h1>Firestore Rules Test</h1>
  <p>Open your DevTools console (F12) to see logs.</p>

  <!-- Use ES modules so we can import from the Firebase CDN -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js";
    import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-firestore.js";

    // REPLACE with your actual config:
    const firebaseConfig = {
      apiKey: "AIzaSyDjhyIwTDLkPRt8Erw3_VszEfcnbSkHhOw",
      authDomain: "neonpulse-7e6aa.firebaseapp.com",
      projectId: "neonpulse-7e6aa",
      storageBucket: "neonpulse-7e6aa.firebasestorage.app",
      messagingSenderId: "77649154549",
      appId: "1:77649154549:web:0d538d42159749162810bc"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    async function testScore() {
      const docRef = doc(db, "highscore", "global");

      try {
        // 1) Read current doc
        const docSnap = await getDoc(docRef);
        if (!docSnap.exists()) {
          // 2) If no doc, create it with score = 100
          await setDoc(docRef, { score: 100 });
          console.log("Created /highscore/global with score=100");
        } else {
          // 3) If doc exists, increment the score by 10
          const current = docSnap.data().score;
          console.log("Doc exists. Current score:", current);
          
          const newScore = current + 10;
          await setDoc(docRef, { score: newScore });
          console.log("Updated score to:", newScore);
        }
      } catch (err) {
        console.error("Error in testScore:", err);
      }
    }

    // Run the test
    testScore();
  </script>
</body>
</html>
